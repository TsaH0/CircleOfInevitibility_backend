# Render Blueprint Configuration
# https://render.com/docs/blueprint-spec

services:
  - type: web
    name: mastercp-backend
    runtime: python
    region: oregon  # Choose: oregon, ohio, virginia, frankfurt, singapore
    plan: free  # Options: free, starter, standard, pro

    # Root directory containing the backend code
    rootDir: backend

    # Build command - install dependencies
    buildCommand: pip install -r requirements.txt

    # Start command - run FastAPI with uvicorn
    startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT

    # Health check endpoint
    healthCheckPath: /health

    # Environment variables
    envVars:
      # Python environment
      - key: PYTHON_VERSION
        value: "3.11"

      # Database URL - set this in Render dashboard for security
      # Or use fromDatabase if using Render's PostgreSQL
      - key: DATABASE_URL
        sync: false  # Must be set manually in dashboard (contains secrets)

      # OpenRouter API key for AI reflections (optional)
      - key: OPENROUTER_API_KEY
        sync: false  # Must be set manually in dashboard

      # Environment mode
      - key: ENVIRONMENT
        value: production

    # Auto-deploy on push to main branch
    autoDeploy: true
